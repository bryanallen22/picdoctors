(function(){(function(e,t){var n,r;return r=t.document,n=function(){function n(t){var n=this;this._options=e.extend({name:"tour",labels:{end:"End tour",next:"Next &raquo;",prev:"&laquo; Prev"},keyboard:!0,useLocalStorage:!1,afterSetState:function(e,t){},afterGetState:function(e,t){},onStart:function(e){},onEnd:function(e){},onShow:function(e){},onHide:function(e){},onShown:function(e){}},t),this._steps=[],this.setCurrentStep(),this._onresize(function(){if(!n.ended)return n.showStep(n._current)})}return n.prototype.setState=function(n,r){return this._options.useLocalStorage?t.localStorage.setItem(""+this._options.name+"_"+n,r):e.cookie(""+this._options.name+"_"+n,r,{expires:36500,path:"/"}),this._options.afterSetState(n,r)},n.prototype.getState=function(n){var r;return this._options.useLocalStorage?r=t.localStorage.getItem(""+this._options.name+"_"+n):r=e.cookie(""+this._options.name+"_"+n),this._options.afterGetState(n,r),r},n.prototype.addStep=function(e){return this._steps.push(e)},n.prototype.getStep=function(t){if(this._steps[t]!=null)return e.extend({path:"",placement:"right",title:"",content:"",next:t===this._steps.length-1?-1:t+1,prev:t-1,animation:!0,onShow:this._options.onShow,onHide:this._options.onHide,onShown:this._options.onShown},this._steps[t])},n.prototype.start=function(t){var n=this;t==null&&(t=!1);if(this.ended()&&!t)return;return e(r).off("click.bootstrap-tour",".popover .next").on("click.bootstrap-tour",".popover .next",function(e){return e.preventDefault(),n.next()}),e(r).off("click.bootstrap-tour",".popover .prev").on("click.bootstrap-tour",".popover .prev",function(e){return e.preventDefault(),n.prev()}),e(r).off("click.bootstrap-tour",".popover .end").on("click.bootstrap-tour",".popover .end",function(e){return e.preventDefault(),n.end()}),this._setupKeyboardNavigation(),this._options.onStart!=null&&this._options.onStart(this),this.showStep(this._current)},n.prototype.next=function(){return this.hideStep(this._current),this.showNextStep()},n.prototype.prev=function(){return this.hideStep(this._current),this.showPrevStep()},n.prototype.end=function(){this.hideStep(this._current),e(r).off(".bootstrap-tour"),this.setState("end","yes");if(this._options.onEnd!=null)return this._options.onEnd(this)},n.prototype.ended=function(){return!!this.getState("end")},n.prototype.restart=function(){return this.setState("current_step",null),this.setState("end",null),this.setCurrentStep(0),this.start()},n.prototype.hideStep=function(t){var n;return n=this.getStep(t),n.onHide!=null&&n.onHide(this),e(n.element).popover("hide")},n.prototype.showStep=function(t){var n;n=this.getStep(t);if(!n)return;this.setCurrentStep(t);var i=n.path.indexOf("?"),s=i>0?n.path.substring(0,i):n.path;i=n.path.indexOf("#"),s=i>0?s.substring(0,i):s;if(n.path!==""&&r.location.pathname!==s&&r.location.pathname.replace(/^.*[\\\/]/,"")!==n.path){r.location.href=n.path;return}n.onShow!=null&&n.onShow(this);if(n.element==null||e(n.element).length===0||!e(n.element).is(":visible")){this.showNextStep();return}this._showPopover(n,t);if(n.onShown!=null)return n.onShown(this)},n.prototype.setCurrentStep=function(e){return e!=null?(this._current=e,this.setState("current_step",e)):(this._current=this.getState("current_step"),this._current===null||this._current==="null"?this._current=0:this._current=parseInt(this._current))},n.prototype.showNextStep=function(){var e;return e=this.getStep(this._current),this.showStep(e.next)},n.prototype.showPrevStep=function(){var e;return e=this.getStep(this._current),this.showStep(e.prev)},n.prototype._showPopover=function(t,n){var r,i,s,o,u=this;return r=""+t.content+"<br /><p>",s=e.extend({},this._options),t.options&&e.extend(s,t.options),t.reflex&&(e(t.element).css("cursor","pointer"),e(t.element).on("click",function(n){return e(t.element).css("cursor","auto"),u.next()})),i=[],t.prev>=0&&i.push("<a href='#"+t.prev+"' class='prev'>"+s.labels.prev+"</a>"),t.next>=0&&i.push("<a href='#"+t.next+"' class='next'>"+s.labels.next+"</a>"),r+=i.join(" | "),r+="<a href='#' class='pull-right end'>"+s.labels.end+"</a>",e(t.element).popover("destroy").popover({placement:t.placement,trigger:"manual",title:t.title,content:r,html:!0,animation:t.animation}).popover("show"),o=e(t.element).data("popover").tip(),this._reposition(o),this._scrollIntoView(o)},n.prototype._reposition=function(t){var n,i,s;return s=t.offset(),n=e(r).outerHeight()-s.top-e(t).outerHeight(),n<0&&(s.top=s.top+n),i=e(r).outerWidth()-s.left-e(t).outerWidth(),i<0&&(s.left=s.left+i),s.top<0&&(s.top=0),s.left<0&&(s.left=0),t.offset(s)},n.prototype._scrollIntoView=function(n){var r;r=n.get(0).getBoundingClientRect();if(!(r.top>0&&r.bottom<e(t).height()&&r.left>0&&r.right<e(t).width()))return n.get(0).scrollIntoView(!0)},n.prototype._onresize=function(n,r){return e(t).resize(function(){return clearTimeout(r),r=setTimeout(n,100)})},n.prototype._setupKeyboardNavigation=function(){var t=this;if(this._options.keyboard)return e(r).on("keyup.bootstrap-tour",function(e){if(!e.which)return;switch(e.which){case 39:e.preventDefault();if(t._current<t._steps.length-1)return t.next();break;case 37:e.preventDefault();if(t._current>0)return t.prev()}})},n}(),t.Tour=n})(jQuery,window)}).call(this);
