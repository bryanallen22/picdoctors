{% extends 'account_settings.html' %}

{% block settings_tabs %}
      <li><a id="bank_tab" href="#bank_pane" data-toggle="tab">Bank Transfer</a></li>
      <li><a id="merchant_tab" href="#merchant_pane" data-toggle="tab">Merchant Info</a></li>
{% endblock %}

{% block settings_body %}

      {#####################################################}
      {# Bank Account Pane                                 #}
      {#####################################################}
      <div class="tab-pane fade" id="bank_pane">
        {# List saved bank accounts #}
        {% if bank_accounts %}
          <h5>Your bank account details:</h5>
          {% for ba in bank_accounts %}
            <dl>
              <dt>
                <dd>Bank Name: {{ ba.bank_name|capfirst }}</dd>
                <dd>Name: {{ ba.name }}</dd>
                <dd>Type: {{ ba.type|capfirst }}</dd>
                <dd>Account Number: {{ ba.account_number }}</dd>
                <dd>Routing Number: {{ ba.routing_number }}</dd>
              </dt>
              <p class="uri" style='display:none;'>{{ ba.uri }}</p>
              <br/>
              <a class="btn btn-danger delete_bank_account" href="#"><i class="icon-trash icon-white"></i>Delete</a>
            </dl>
          {% endfor %}
        {% else %}
          <h3>You do not have a bank account saved. You will not be
            able to withdraw money until you add one.</h3>

          <div class="alert alert-error">
            <button class="close" data-dismiss="alert">×</button>
            <strong>Warning!</strong>
            Please be careful when entering your bank account information!
            <br/>
            Due to the nature of the ACH network, it can take up to <strong>5 business days</strong>
            for us to even find out that the transfer failed.
          </div>

          <img src="{{ STATIC_URL }}images/check_image.png">
          <br/> <br/>

          <form action="#" method="POST" id="bank-account-form" class="form-horizontal">
            <fieldset>
              <legend>Bank Account Information</legend>

              <div class="control-group">
                <label class="control-label" for="ba-name" >Account Holder's Name</label>
                <div class="controls">
                  <input type="text"
                      autocomplete="off"
                      placeholder="Bank Account Holder's name"
                      id="ba-name"
                      class="ba-name">
                </div>
              </div>

              <div class="control-group">
                <label class="control-label" for="ba-rn" >Routing Number</label>
                <div class="controls">
                  <input type="text"
                      autocomplete="off"
                      placeholder="Routing Number"
                      id="ba-rn"
                      class="ba-rn">
                </div>
              </div>

              <div class="control-group">
                <label class="control-label" for="ba-an" >Account Number</label>
                <div class="controls">
                  <input type="text"
                      autocomplete="off"
                      placeholder="Account Number"
                      id="ba-an"
                      class="ba-an">
                </div>
              </div>

              <div class="control-group">
                <label class="control-label" for="ba-acct-type" >Account Type</label>
                <div class="controls">
                  <select id="ba-acct-type">
                    <option value='' disabled selected style='display:none;'>
                    Select Account Type
                    </option>
                    <option value="checking">CHECKING</option>
                    <option value="savings">SAVINGS</option>
                  </select>
                </div>
              </div>

              <div class="control-group">
                <label class="control-label"></label>
                <div class="controls">
                  <button type="submit" class="btn btn-primary">
                    Create Account
                  </button>
                </div>
              </div>

            </fieldset>
          </form>
          <p id="error_bankaccount" class="label label-important balanced_error" style="display:none;">Invalid Bank Account Information, please try again.</p>

          {% if not request.IS_PRODUCTION %}
            {# Include some debug accounts #}
            <div class="row">
              <div class="span7">
                Test Bank Accounts:<br/>
                <button id="btn-badrouting" type="submit" class="btn btn-info">Invalid Routing Number</button>
                <button id="btn-pending" type="submit" class="btn btn-warning">State -> Pending</button>
                <button id="btn-paid" type="submit" class="btn btn-danger">State -> Paid</button>
                <button id="btn-failed" type="submit" class="btn btn-success">State -> Failed</button>
              </div>
            </div>

          {% endif %}
        {% endif %}
      </div>

      {#####################################################}
      {# Merchant Underwriting Pane                        #}
      {#####################################################}
      <div class="tab-pane fade" id="merchant_pane">
        <h3>Merchant Information</h3>
        {% if is_merchant %}
          <div class="alert alert-success">
            <button class="close" data-dismiss="alert">×</button>
            We've already got your merchant info, thanks!
          </div>

        {% else %}
          <div class="alert alert-error">
            <button class="close" data-dismiss="alert">×</button>
            We're legally required to collect some information to satisfy 'Know Your Customer' and Anti-Money Laundering laws.
          </div>
          <form action="{% url 'merchant_info' %}" method="POST" id="bank-account-form" class="form-horizontal">
            {% csrf_token %}

            <div class="control-group">
              <label class="control-label">Business Type</label>
              <div class="controls">
                <label class="radio">
                  <input type="radio" name="merchant_type" id="person" value="person" checked>
                  Individual
                </label>
                <label class="radio">
                  <input type="radio" name="merchant_type" id="business" value="business">
                  Business
                </label>
              </div>
            </div>

            {########################}
            {# Business only fields #}
            {########################}
            <div class="control-group business_field" style="display:none;">
              <label class="control-label" for="business_name">
                Business Name
              </label>
              <div class="controls">
                <input type="text"
                    placeholder="John's Photography"
                    id="business_name"
                    name="business_name">
              </div>
            </div>

            <div class="control-group business_field" style="display:none;">
              <label class="control-label" for="business_street_address">
                Business Street Address
              </label>
              <div class="controls">
                <input type="text"
                  placeholder="222 Aperture Way"
                  id="business_street_address"
                  name="business_street_address">
              </div>
            </div>

            <div class="control-group business_field" style="display:none;">
              <label class="control-label" for="business_postal_code">
                Business Postal Code
              </label>
              <div class="controls">
                <input type="text"
                    placeholder="12345"
                    id="business_postal_code"
                    name="business_postal_code">
              </div>
            </div>

            <div class="control-group business_field" style="display:none;">
              <label class="control-label" for="business_phone_number">
                Business Phone Number
              </label>
              <div class="controls">
                <input type="text"
                    class="phone_number"
                    placeholder="(987) 654-3210"
                    id="business_phone_number"
                    name="business_phone_number">
              </div>
            </div>

            <div class="control-group business_field" style="display:none;">
              <label class="control-label" for="business_tax_id">
                Federal Tax Id
              </label>
              <div class="controls">
                <input type="text"
                    placeholder="211111111"
                    id="business_tax_id"
                    name="business_tax_id">
              </div>
            </div>

            {#########################################}
            {# Person fields (used for business too) #}
            {#########################################}
            <div class="control-group" >
              <label class="control-label" for="name">
                Your Name
              </label>
              <div class="controls">
                <input type="text"
                    placeholder="John Doe"
                    id="name"
                    name="name">
              </div>
            </div>

            <div class="control-group" >
              <label class="control-label" for="street_address">
                Your Street Address
              </label>
              <div class="controls">
                <input type="text"
                    placeholder="123 Cherry Lane"
                    id="street_address"
                    name="street_address">
              </div>
            </div>

            <div class="control-group" >
              <label class="control-label" for="postal_code">
                Your Postal Code
              </label>
              <div class="controls">
                <input type="text"
                  placeholder="12345"
                  id="postal_code"
                  name="postal_code">
              </div>
            </div>

            <div class="control-group" >
              <label class="control-label" for="phone_number">
                Your Phone Number
              </label>
              <div class="controls">
                <input type="text"
                    class="phone_number"
                    placeholder="(987) 654-3210"
                    id="phone_number"
                    name="phone_number">
              </div>
            </div>

            <div class="control-group" >
              <label class="control-label" for="birth_month">
                Your Birth Month
              </label>
              <div class="controls">
                <select id="birth_month" name="birth_month">
                  <option value="1">January</option>
                  <option value="2">February</option>
                  <option value="3">March</option>
                  <option value="4">April</option>
                  <option value="5">May</option>
                  <option value="6">June</option>
                  <option value="7">July</option>
                  <option value="8">August</option>
                  <option value="9">September</option>
                  <option value="10">October</option>
                  <option value="11">November</option>
                  <option value="12">December</option>
                </select>
              </div>
            </div>

            <div class="control-group" >
              <label class="control-label" for="birth_year">
                Your Birth Year
              </label>
              <div class="controls">
                <input type="text"
                    placeholder="1980"
                    id="birth_year"
                    name="birth_year">
              </div>
            </div>

            <div class="control-group">
              <label class="control-label"></label>
              <div class="controls">
                <input type="submit" name="submit" class='btn btn-primary' value="Submit" >
              </div>
            </div>

          </form>

        {% endif %}
      </div>
{% endblock %}
{% block sub_scripts %}
{% endblock %}
